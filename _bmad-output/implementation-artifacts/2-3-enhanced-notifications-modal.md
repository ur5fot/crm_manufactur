# Story 2.3: –†–æ–∑—à–∏—Ä–µ–Ω–µ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –Ω–∞–≥–∞–¥—É–≤–∞–Ω—å

Status: done

<!-- Note: Validation is optional. Run validate-create-story for quality check before dev-story. -->

## Story

As a –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä,
I want –±–∞—á–∏—Ç–∏ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –∑ –ø–æ–¥—ñ—è–º–∏ –≤—ñ–¥–ø—É—Å—Ç–æ–∫ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏,
So that —è –æ–¥—Ä–∞–∑—É –æ—Ç—Ä–∏–º—É—é –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è –ø—Ä–æ –≤–∞–∂–ª–∏–≤—ñ –ø–æ–¥—ñ—ó –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –¥—ñ–π.

## Acceptance Criteria

1. **Given** —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è —ñ —î –ø–æ–¥—ñ—ó –≤—ñ–¥–ø—É—Å—Ç–æ–∫ —Å—å–æ–≥–æ–¥–Ω—ñ **When** –¥–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ **Then** –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑'—è–≤–ª—è—î—Ç—å—Å—è –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –Ω–∞–≥–∞–¥—É–≤–∞–Ω—å **And** –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –º–∞—î max-width 500px, —Ü–µ–Ω—Ç—Ä–æ–≤–∞–Ω–µ, backdrop rgba(0,0,0,0.3)

2. **Given** –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –≤—ñ–¥–∫—Ä–∏—Ç–µ **When** –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –±–∞—á–∏—Ç—å –≤–º—ñ—Å—Ç **Then** –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –¥–≤—ñ —Å–µ–∫—Ü—ñ—ó: ‚úàÔ∏è "–ô–¥—É—Ç—å —É –≤—ñ–¥–ø—É—Å—Ç–∫—É —Å—å–æ–≥–æ–¥–Ω—ñ" (—Å–∏–Ω—ñ–π –∞–∫—Ü–µ–Ω—Ç) ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ –∑ –¥–∞—Ç–æ—é –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è; üè¢ "–ü–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è –∑ –≤—ñ–¥–ø—É—Å—Ç–∫–∏ —Å—å–æ–≥–æ–¥–Ω—ñ" (–∑–µ–ª–µ–Ω–∏–π –∞–∫—Ü–µ–Ω—Ç) ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤

3. **Given** –Ω–µ–º–∞—î –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ —â–æ –π–¥—É—Ç—å —É –≤—ñ–¥–ø—É—Å—Ç–∫—É —Å—å–æ–≥–æ–¥–Ω—ñ **When** –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è **Then** —Å–µ–∫—Ü—ñ—è "–ô–¥—É—Ç—å —É –≤—ñ–¥–ø—É—Å—Ç–∫—É" –Ω–µ –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è (—Ç—ñ–ª—å–∫–∏ "–ü–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è")

4. **Given** –Ω–µ–º–∞—î –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ —â–æ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è —Å—å–æ–≥–æ–¥–Ω—ñ **When** –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è **Then** —Å–µ–∫—Ü—ñ—è "–ü–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è" –Ω–µ –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è (—Ç—ñ–ª—å–∫–∏ "–ô–¥—É—Ç—å —É –≤—ñ–¥–ø—É—Å—Ç–∫—É")

5. **Given** –Ω–µ–º–∞—î –∂–æ–¥–Ω–∏—Ö –ø–æ–¥—ñ–π —Å—å–æ–≥–æ–¥–Ω—ñ **When** —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è **Then** –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ù–ï –∑'—è–≤–ª—è—î—Ç—å—Å—è

6. **Given** –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –≤—ñ–¥–∫—Ä–∏—Ç–µ **When** –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–∞—Ç–∏—Å–∫–∞—î –∫–Ω–æ–ø–∫—É "–ó–∞–∫—Ä–∏—Ç–∏" –∞–±–æ Escape **Then** –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è **And** –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –±–∞—á–∏—Ç—å Dashboard

## Tasks / Subtasks

- [x] Task 1: –û–Ω–æ–≤–∏—Ç–∏ backdrop –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ (AC: #1)
  - [x] 1.1: –ó–º—ñ–Ω–∏—Ç–∏ CSS `.vacation-notification-overlay` background –∑ `rgba(0, 0, 0, 0.5)` –Ω–∞ `rgba(0, 0, 0, 0.3)` (–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å UX spec)
- [x] Task 2: –î–æ–¥–∞—Ç–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫—É –∫–ª–∞–≤—ñ—à—ñ Escape –¥–ª—è –∑–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª–∫–∏ (AC: #6)
  - [x] 2.1: –î–æ–¥–∞—Ç–∏ –æ–±—Ä–æ–±–Ω–∏–∫ `@keydown.escape` –¥–ª—è –∑–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞
  - [x] 2.2: –í–∞—Ä—ñ–∞–Ω—Ç —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó A: –¥–æ–¥–∞—Ç–∏ `@keydown.escape.window="closeVacationNotification"` –Ω–∞ overlay div (Vue directive) ‚Äî –ù–ï –û–ë–†–ê–ù–û
  - [x] 2.3: –í–∞—Ä—ñ–∞–Ω—Ç —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó B: –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ `onMounted` + `addEventListener('keydown', ...)` –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é `showVacationNotification.value` —Ç–∞ `event.key === 'Escape'` + `onUnmounted` cleanup ‚Äî –û–ë–†–ê–ù–û
  - [x] 2.4: –û–±—Ä–∞—Ç–∏ –≤–∞—Ä—ñ–∞–Ω—Ç —â–æ –∫—Ä–∞—â–µ –≤–ø–∏—Å—É—î—Ç—å—Å—è –≤ —ñ—Å–Ω—É—é—á–∏–π –∫–æ–¥ ‚Äî –æ–±—Ä–∞–Ω–æ –≤–∞—Ä—ñ–∞–Ω—Ç B (onMounted/onUnmounted)
- [x] Task 3: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É—é—á–æ—ó –ª–æ–≥—ñ–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ AC (AC: #1-#5)
  - [x] 3.1: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –º–æ–¥–∞–ª–∫–∞ –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –∫–æ–ª–∏ —î –ø–æ–¥—ñ—ó (AC: #5 ‚Äî `if (returningToday.length > 0 || startingToday.length > 0)`)
  - [x] 3.2: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ —Å–µ–∫—Ü—ñ—è "–ô–¥—É—Ç—å —É –≤—ñ–¥–ø—É—Å—Ç–∫—É" –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞ –∫–æ–ª–∏ `vacationStarting.length === 0` (AC: #3 ‚Äî —á–µ—Ä–µ–∑ `v-if`)
  - [x] 3.3: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ —Å–µ–∫—Ü—ñ—è "–ü–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è" –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞ –∫–æ–ª–∏ `vacationReturning.length === 0` (AC: #4 ‚Äî —á–µ—Ä–µ–∑ `v-if`)
  - [x] 3.4: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –∫–Ω–æ–ø–∫–∞ "–ó—Ä–æ–∑—É–º—ñ–ª–æ" —Ç–∞ backdrop click –∑–∞–∫—Ä–∏–≤–∞—é—Ç—å –º–æ–¥–∞–ª–∫—É (AC: #6)
  - [x] 3.5: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –º–æ–¥–∞–ª–∫–∞ –º–∞—î max-width 500px (AC: #1 ‚Äî —á–µ—Ä–µ–∑ CSS)
- [x] Task 4: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è (AC: #1-#6)
  - [x] 4.1: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –º–æ–¥–∞–ª–∫–∞ –∑'—è–≤–ª—è—î—Ç—å—Å—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –∫–æ–ª–∏ —î –ø–æ–¥—ñ—ó —Å—å–æ–≥–æ–¥–Ω—ñ
  - [x] 4.2: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –º–æ–¥–∞–ª–∫–∞ –ù–ï –∑'—è–≤–ª—è—î—Ç—å—Å—è –∫–æ–ª–∏ –Ω–µ–º–∞—î –ø–æ–¥—ñ–π
  - [x] 4.3: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ backdrop rgba(0,0,0,0.3)
  - [x] 4.4: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Escape key –∑–∞–∫—Ä–∏–≤–∞—î –º–æ–¥–∞–ª–∫—É
  - [x] 4.5: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ production build –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –±–µ–∑ –ø–æ–º–∏–ª–æ–∫ (`cd client && npm run build`)

## Dev Notes

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è —Ç–∞ –ø–∞—Ç–µ—Ä–Ω–∏

- **Brownfield –ø—Ä–æ—î–∫—Ç** ‚Äî —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –≤ App.vue, –ù–ï —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ
- **–ë–µ–∑ –Ω–æ–≤–∏—Ö npm –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π Vue 3 + DOM API
- **CSS –ø—ñ–¥—Ö—ñ–¥** ‚Äî —Å—Ç–∏–ª—ñ –º–æ–¥–∏—Ñ—ñ–∫—É—é—Ç—å—Å—è –≤–∏–∫–ª—é—á–Ω–æ –≤ `client/src/styles.css`, –æ–∫—Ä–µ–º—ñ CSS —Ñ–∞–π–ª–∏ –ó–ê–ë–û–†–û–ù–ï–ù–Ü
- **State management:** —ñ—Å–Ω—É—é—á—ñ `ref()` ‚Äî `showVacationNotification`, `vacationStarting`, `vacationReturning`
- **Naming conventions:** camelCase –¥–ª—è JS, kebab-case –¥–ª—è CSS
- **–ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–∏** ‚Äî –±—ñ–ª—å—à—ñ—Å—Ç—å AC –≤–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ, –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ª–∏—à–µ 2 –∑–º—ñ–Ω–∏: backdrop opacity —Ç–∞ Escape key handler

### –ê–Ω–∞–ª—ñ–∑ –ø–æ—Ç–æ—á–Ω–æ—ó —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó vs Acceptance Criteria

**–ö–†–ò–¢–ò–ß–ù–û: –ë—ñ–ª—å—à—ñ—Å—Ç—å —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –≤–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞!** –¶—è story –ø–µ—Ä–µ–≤–∞–∂–Ω–æ –í–ê–õ–Ü–î–ê–¶–Ü–ô–ù–ê –∑ –¥–≤–æ–º–∞ –Ω–µ–≤–µ–ª–∏–∫–∏–º–∏ –∑–º—ñ–Ω–∞–º–∏.

| AC | –°—Ç–∞—Ç—É—Å | –©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ |
|----|--------|-------------|
| #1 –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–æ—è–≤–∞ –º–æ–¥–∞–ª–∫–∏ –∑ –ø–æ–¥—ñ—è–º–∏ | ‚úÖ –í–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ | –ó–º—ñ–Ω–∏—Ç–∏ backdrop –∑ 0.5 ‚Üí 0.3 |
| #2 –î–≤—ñ —Å–µ–∫—Ü—ñ—ó (—Å–∏–Ω—ñ–π/–∑–µ–ª–µ–Ω–∏–π –∞–∫—Ü–µ–Ω—Ç) | ‚úÖ –í–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ | –ù—ñ—á–æ–≥–æ (CSS –≤–∂–µ –º–∞—î `.starting` blue, `.returning` green) |
| #3 –°–µ–∫—Ü—ñ—è "–ô–¥—É—Ç—å" –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞ –±–µ–∑ –ø–æ–¥—ñ–π | ‚úÖ –í–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ | –ù—ñ—á–æ–≥–æ (`v-if="vacationStarting.length > 0"`) |
| #4 –°–µ–∫—Ü—ñ—è "–ü–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è" –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞ –±–µ–∑ –ø–æ–¥—ñ–π | ‚úÖ –í–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ | –ù—ñ—á–æ–≥–æ (`v-if="vacationReturning.length > 0"`) |
| #5 –ú–æ–¥–∞–ª–∫–∞ –ù–ï –∑'—è–≤–ª—è—î—Ç—å—Å—è –±–µ–∑ –ø–æ–¥—ñ–π | ‚úÖ –í–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ | –ù—ñ—á–æ–≥–æ (`showVacationNotification` = true —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –ø–æ–¥—ñ–π) |
| #6 –ó–∞–∫—Ä–∏—Ç—Ç—è –∫–Ω–æ–ø–∫–æ—é –∞–±–æ Escape | ‚ö†Ô∏è –ß–∞—Å—Ç–∫–æ–≤–æ | **–î–æ–¥–∞—Ç–∏ Escape key handler** (–∫–Ω–æ–ø–∫–∞ + backdrop click –≤–∂–µ —î) |

### –ü–æ—Ç–æ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è (—â–æ –º–æ–¥–∏—Ñ—ñ–∫—É—î–º–æ)

**Vacation notification refs (App.vue —Ä—è–¥–∫–∏ ~132-135):**
```javascript
const vacationReturning = ref([]);
const vacationStarting = ref([]);
const showVacationNotification = ref(false);
```

**checkVacations() (App.vue —Ä—è–¥–∫–∏ ~430-525):**
–§—É–Ω–∫—Ü—ñ—è –≤–∂–µ –∫–æ—Ä–µ–∫—Ç–Ω–æ:
1. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è —Å—å–æ–≥–æ–¥–Ω—ñ ‚Üí `returningToday[]`
2. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –ø–æ—á–∞—Ç–æ–∫ –≤—ñ–¥–ø—É—Å—Ç–∫–∏ —Å—å–æ–≥–æ–¥–Ω—ñ ‚Üí `startingToday[]`
3. –ü–æ–∫–∞–∑—É—î –º–æ–¥–∞–ª–∫—É —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ —î –ø–æ–¥—ñ—ó: `if (returningToday.length > 0 || startingToday.length > 0)`
4. –û–Ω–æ–≤–ª—é—î —Å—Ç–∞—Ç—É—Å–∏ —á–µ—Ä–µ–∑ API
5. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î employees –ø—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω—å

**closeVacationNotification (App.vue —Ä—è–¥–∫–∏ ~527-529):**
```javascript
function closeVacationNotification() {
  showVacationNotification.value = false;
}
```

**Modal template (App.vue —Ä—è–¥–∫–∏ ~856-895):**
```html
<div v-if="showVacationNotification" class="vacation-notification-overlay" @click="closeVacationNotification">
  <div class="vacation-notification-modal" @click.stop>
    <!-- header –∑ close-btn, body –∑ –¥–≤–æ–º–∞ —Å–µ–∫—Ü—ñ—è–º–∏, footer –∑ –∫–Ω–æ–ø–∫–æ—é "–ó—Ä–æ–∑—É–º—ñ–ª–æ" -->
  </div>
</div>
```
- ‚úÖ `v-if` –Ω–∞ overlay ‚Äî –º–æ–¥–∞–ª–∫–∞ –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å—Å—è –±–µ–∑ –ø–æ–¥—ñ–π
- ‚úÖ `@click` –Ω–∞ overlay ‚Äî –∑–∞–∫—Ä–∏—Ç—Ç—è –ø–æ backdrop
- ‚úÖ `@click.stop` –Ω–∞ modal ‚Äî –∫–ª—ñ–∫ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –Ω–µ –∑–∞–∫—Ä–∏–≤–∞—î
- ‚úÖ –°–µ–∫—Ü—ñ—è `.starting` (blue) –¥–ª—è –≤—ñ–¥–ø—É—Å—Ç–æ–∫ —â–æ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è
- ‚úÖ –°–µ–∫—Ü—ñ—è `.returning` (green) –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω—å
- ‚úÖ `v-if` –Ω–∞ –∫–æ–∂–Ω—É —Å–µ–∫—Ü—ñ—é ‚Äî –ø—Ä–∏—Ö–æ–≤—É—î –ø–æ—Ä–æ–∂–Ω—ñ
- ‚ö†Ô∏è –ù–ï–ú–ê–Ñ `@keydown.escape` –¥–ª—è –∑–∞–∫—Ä–∏—Ç—Ç—è –ø–æ Escape

**–ü–æ—Ç–æ—á–Ω–∏–π CSS (styles.css —Ä—è–¥–∫–∏ ~952-960):**
```css
.vacation-notification-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0.5);  /* ‚Üê –ó–ú–Ü–ù–ò–¢–ò –Ω–∞ 0.3 */
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  animation: fadeIn 0.3s ease;
}
```

### –¶—ñ–ª—å–æ–≤–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

**–ó–º—ñ–Ω–∞ 1: Backdrop opacity (styles.css)**

–ó–Ω–∞–π—Ç–∏:
```css
background: rgba(0, 0, 0, 0.5);
```
–ó–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞:
```css
background: rgba(0, 0, 0, 0.3);
```

**–ó–º—ñ–Ω–∞ 2: Escape key handler (App.vue)**

–ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π –ø—ñ–¥—Ö—ñ–¥ ‚Äî –¥–æ–¥–∞—Ç–∏ watcher –Ω–∞ `showVacationNotification` —è–∫–∏–π –¥–æ–¥–∞—î/–≤–∏–¥–∞–ª—è—î keydown listener:

```javascript
// Escape key –¥–ª—è –∑–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –Ω–∞–≥–∞–¥—É–≤–∞–Ω—å
watch(showVacationNotification, (isVisible) => {
  if (isVisible) {
    const handler = (e) => {
      if (e.key === 'Escape') {
        closeVacationNotification();
        document.removeEventListener('keydown', handler);
      }
    };
    document.addEventListener('keydown', handler);
  }
});
```

–ê–ë–û –ø—Ä–æ—Å—Ç—ñ—à–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –∑ `onMounted`/`onUnmounted`:

```javascript
function handleEscapeKey(e) {
  if (e.key === 'Escape' && showVacationNotification.value) {
    closeVacationNotification();
  }
}
onMounted(() => {
  document.addEventListener('keydown', handleEscapeKey);
});
onUnmounted(() => {
  document.removeEventListener('keydown', handleEscapeKey);
});
```

–†–µ–∫–æ–º–µ–Ω–¥—É—é **–¥—Ä—É–≥–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç** ‚Äî —á–∏—Å—Ç—ñ—à–∏–π, —î–¥–∏–Ω–∏–π listener –Ω–∞ –≤–µ—Å—å lifecycle, –±–µ–∑ memory leak —Ä–∏–∑–∏–∫—É.

### –í–∞–∂–ª–∏–≤—ñ –¥–µ—Ç–∞–ª—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

1. **–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π scope –∑–º—ñ–Ω** ‚Äî —Ü–µ story –ø–æ —Å—É—Ç—ñ –ø–æ—Ç—Ä–µ–±—É—î –ª–∏—à–µ 2 —Ç–æ—á–∫–æ–≤–∏—Ö –∑–º—ñ–Ω. –†–µ—à—Ç–∞ –≤–∂–µ –ø—Ä–∞—Ü—é—î. –ù–µ —Ä–æ–∑—à–∏—Ä—é–≤–∞—Ç–∏ scope!

2. **Escape handler –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—É–≤–∞—Ç–∏** –∑ —ñ–Ω—à–∏–º–∏ –º–æ–¥–∞–ª–∫–∞–º–∏ (delete confirmation, import). –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ `showVacationNotification.value` –≥–∞—Ä–∞–Ω—Ç—É—î —â–æ Escape –∑–∞–∫—Ä–∏–≤–∞—î —Ç—ñ–ª—å–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω—É –º–æ–¥–∞–ª–∫—É.

3. **`checkVacations()` –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `today` —á–µ—Ä–µ–∑ `new Date().toISOString().split('T')[0]`** ‚Äî –£–í–ê–ì–ê: Story 2.1 –≤–∏—è–≤–∏–ª–∞ timezone issue –∑ `toISOString()` (–¥–∏–≤. code review fix M1). –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ `checkVacations()` —Ç–∞–∫–æ–∂ –ø–æ—Ç—Ä–µ–±—É—î –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ `localDateStr()`. –Ø–∫—â–æ `today` —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `toISOString().split('T')[0]`, —Ü–µ –º–æ–∂–µ –¥–∞—Ç–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É –¥–∞—Ç—É –±—ñ–ª—è –æ–ø—ñ–≤–Ω–æ—á—ñ –≤ —á–∞—Å–æ–≤–∏—Ö –ø–æ—è—Å–∞—Ö != UTC.

4. **Backdrop rgba(0,0,0,0.3)** ‚Äî –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ UX specification (—Å–µ–∫—Ü—ñ—è "Layout –∑–∞–≥–∞–ª—å–Ω–∏–π: Modal: centered, max-width 500px, backdrop rgba(0,0,0,0.3)"). –ü–æ—Ç–æ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è 0.5 –±—É–ª–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ä–∞–Ω—ñ—à–µ —ñ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î spec.

5. **max-width 500px –≤–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π** –≤ CSS `.vacation-notification-modal` ‚Äî –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î AC#1.

6. **–ê–Ω—ñ–º–∞—Ü—ñ—ó –≤–∂–µ —î** ‚Äî `fadeIn` –¥–ª—è overlay, `slideUp` –¥–ª—è modal. –ù–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏.

### UX —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

- **Backdrop:** rgba(0,0,0,0.3) ‚Äî –∑–≥—ñ–¥–Ω–æ UX spec (–∑–∞—Ä–∞–∑ 0.5 ‚Äî –∑–∞–Ω–∞–¥—Ç–æ —Ç–µ–º–Ω–∏–π)
- **Max-width:** 500px ‚Äî ‚úÖ –≤–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ
- **–°–µ–∫—Ü—ñ—è "–ô–¥—É—Ç—å":** blue accent (border-left: #3b82f6, background: #eff6ff) ‚Äî ‚úÖ –≤–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ
- **–°–µ–∫—Ü—ñ—è "–ü–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è":** green accent (border-left: #10b981, background: #f0fdf4) ‚Äî ‚úÖ –≤–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ
- **–ó–∞–∫—Ä–∏—Ç—Ç—è:** –∫–Ω–æ–ø–∫–∞ √ó, backdrop click, Escape key, –∫–Ω–æ–ø–∫–∞ "–ó—Ä–æ–∑—É–º—ñ–ª–æ"
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–æ—è–≤–∞:** —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –ø–æ–¥—ñ–π —Å—å–æ–≥–æ–¥–Ω—ñ (vacation_start –∞–±–æ vacation_end)
- **–¶–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è:** flex align-items + justify-content center ‚Äî ‚úÖ –≤–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

[Source: _bmad-output/planning-artifacts/ux-design-specification.md#–ü–∞—Ç–µ—Ä–Ω–∏ –º–æ–¥–∞–ª—å–Ω–∏—Ö –≤—ñ–∫–æ–Ω]

### –ü–æ–ø–µ—Ä–µ–¥–Ω—è Story Intelligence (Story 2.2)

**–©–æ –±—É–ª–æ –∑—Ä–æ–±–ª–µ–Ω–æ –≤ Story 2.2:**
- `expandedCard` ref + `toggleStatCard()` + `expandedEmployees` computed
- Inline expand blocks inside `.stat-card-wrap` containers
- CSS transition max-height 200ms for expand AND collapse
- Production build passed without errors

**–©–æ –±—É–ª–æ –∑—Ä–æ–±–ª–µ–Ω–æ –≤ Story 2.1:**
- `getDashboardEvents()` backend endpoint
- `dashboardEvents` ref + `loadDashboardEvents()`
- Timeline "–°—å–æ–≥–æ–¥–Ω—ñ" —Ç–∞ "–ù–∞–π–±–ª–∏–∂—á—ñ 7 –¥–Ω—ñ–≤" sections
- Timezone fix: `localDateStr()` –∑–∞–º—ñ—Å—Ç—å `toISOString().slice()` –≤ store.js
- Dynamic schema values –∑–∞–º—ñ—Å—Ç—å hardcoded

**–£—Ä–æ–∫–∏ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö stories:**
- –ó–∞–≤–∂–¥–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ production build –ø—ñ—Å–ª—è –∑–º—ñ–Ω
- Timezone awareness ‚Äî `toISOString()` –º–æ–∂–µ –¥–∞—Ç–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É –¥–∞—Ç—É (Story 2.1 fix M1)
- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–∏ ‚Äî –Ω–µ —Ä–æ–∑—à–∏—Ä—é–≤–∞—Ç–∏ scope
- CSS –∑–º—ñ–Ω–∏ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –≤—ñ–∑—É–∞–ª—å–Ω–æ

**Git commits:**
- `cc58817` Story 2.2: Inline Expand –¥–ª—è Stat Cards ‚Äî —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è + code review fixes
- `cdad612` Story 2.1: Dashboard Events API —Ç–∞ Timeline —Å–µ–∫—Ü—ñ—ó ‚Äî —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è + code review fixes
- `8fd52f1` Story 1.3: –ê–≤—Ç–æ-—Ä–µ—Ñ—Ä–µ—à Dashboard —Ç–∞ Timestamp Footer
- `a992c15` Story 1.2: Dashboard API —Ç–∞ Stat Cards
- `331b6e3` Story 1.1: Tab Bar –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è

### –ü–æ—Ç–µ–Ω—Ü—ñ–∞–ª—å–Ω–µ timezone –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è (OPTIONAL)

**–£–í–ê–ì–ê:** `checkVacations()` –Ω–∞ —Ä—è–¥–∫—É ~433 –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î:
```javascript
const today = new Date().toISOString().split('T')[0];
```

–¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –º–∞—î timezone issue (–≤–∏—è–≤–ª–µ–Ω–∏–π —Ç–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤ Story 2.1 –¥–ª—è store.js ‚Äî commit `cdad612`, fix M1). –ë—ñ–ª—è –æ–ø—ñ–≤–Ω–æ—á—ñ –≤ —á–∞—Å–æ–≤–∏—Ö –ø–æ—è—Å–∞—Ö –∑—ñ –∑—Å—É–≤–æ–º –≤—ñ–¥ UTC, `toISOString()` –º–æ–∂–µ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –≤—á–æ—Ä–∞—à–Ω—é –∞–±–æ –∑–∞–≤—Ç—Ä–∞—à–Ω—é –¥–∞—Ç—É.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –ó–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ `localDateStr()` –∞–±–æ inline –∞–Ω–∞–ª–æ–≥:
```javascript
const now = new Date();
const today = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;
```

–¶–µ –Ω–µ –≤ scope AC, –∞–ª–µ –≤–∏–ø—Ä–∞–≤–ª—è—î –≤—ñ–¥–æ–º–∏–π –±–∞–≥. –†—ñ—à–µ–Ω–Ω—è –Ω–∞ —Ä–æ–∑—Å—É–¥ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞.

### Anti-patterns (–ó–ê–ë–û–†–û–ù–ï–ù–û)

- –ù–ï —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–æ–≤–∏–π –º–æ–¥–∞–ª—å–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî —Ä–æ–∑—à–∏—Ä—é–≤–∞—Ç–∏ —ñ—Å–Ω—É—é—á–∏–π HTML –≤ App.vue
- –ù–ï –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤–∏—Ö API endpoints ‚Äî –≤—Å—è –ª–æ–≥—ñ–∫–∞ –≤–∂–µ –Ω–∞ –∫–ª—ñ—î–Ω—Ç—ñ
- –ù–ï –∑–º—ñ–Ω—é–≤–∞—Ç–∏ `checkVacations()` –ª–æ–≥—ñ–∫—É (–∫—Ä—ñ–º optional timezone fix) ‚Äî –≤–æ–Ω–∞ –ø—Ä–∞—Ü—é—î –∫–æ—Ä–µ–∫—Ç–Ω–æ
- –ù–ï –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤–∏—Ö npm –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
- –ù–ï —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –æ–∫—Ä–µ–º–∏—Ö CSS —Ñ–∞–π–ª—ñ–≤
- –ù–ï –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∞–Ω—ñ–º–∞—Ü—ñ—ó fadeIn/slideUp ‚Äî –≤–æ–Ω–∏ –ø—Ä–∞—Ü—é—é—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–æ
- –ù–ï –º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –∫–æ–ª—ñ—Ä–Ω—É –ø–∞–ª—ñ—Ç—Ä—É —Å–µ–∫—Ü—ñ–π (.starting blue, .returning green)
- –ù–ï –¥–æ–¥–∞–≤–∞—Ç–∏ Vuex/Pinia –¥–ª—è state management –º–æ–¥–∞–ª–∫–∏
- –ù–ï –¥–æ–¥–∞–≤–∞—Ç–∏ "Don't show again" –∞–±–æ cookie persistence ‚Äî –Ω–µ –≤ scope

### Project Structure Notes

- –ó–º—ñ–Ω–∏ –≤ 2 —Ñ–∞–π–ª–∞—Ö: `client/src/App.vue`, `client/src/styles.css`
- –ù—ñ—è–∫–∏—Ö –Ω–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤ –Ω–µ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è
- –ù—ñ—è–∫–∏—Ö –Ω–æ–≤–∏—Ö npm –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
- –ù—ñ—è–∫–∏—Ö –Ω–æ–≤–∏—Ö API endpoints
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É –ø–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —ñ—Å–Ω—É—é—á—ñ–π –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—ñ

### References

- [Source: _bmad-output/planning-artifacts/epics.md#Story 2.3: –†–æ–∑—à–∏—Ä–µ–Ω–µ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –Ω–∞–≥–∞–¥—É–≤–∞–Ω—å]
- [Source: _bmad-output/planning-artifacts/prd.md#FR7 ‚Äî –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ]
- [Source: _bmad-output/planning-artifacts/prd.md#FR8 ‚Äî –î–≤—ñ —Å–µ–∫—Ü—ñ—ó –≤ –º–æ–¥–∞–ª—å–Ω–æ–º—É –≤—ñ–∫–Ω—ñ]
- [Source: _bmad-output/planning-artifacts/prd.md#FR9 ‚Äî –ó–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞]
- [Source: _bmad-output/planning-artifacts/architecture.md#Frontend Architecture ‚Äî Vacation status automation]
- [Source: _bmad-output/planning-artifacts/architecture.md#Implementation Patterns ‚Äî Structure Patterns]
- [Source: _bmad-output/planning-artifacts/ux-design-specification.md#–ü–∞—Ç–µ—Ä–Ω–∏ –º–æ–¥–∞–ª—å–Ω–∏—Ö –≤—ñ–∫–æ–Ω]
- [Source: _bmad-output/planning-artifacts/ux-design-specification.md#–í—ñ–∑—É–∞–ª—å–Ω–∏–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç ‚Äî Layout –∑–∞–≥–∞–ª—å–Ω–∏–π]
- [Source: client/src/App.vue#L132-135 ‚Äî vacation notification refs]
- [Source: client/src/App.vue#L430-525 ‚Äî checkVacations() function]
- [Source: client/src/App.vue#L527-529 ‚Äî closeVacationNotification()]
- [Source: client/src/App.vue#L856-895 ‚Äî vacation notification modal HTML template]
- [Source: client/src/styles.css#L952-1110 ‚Äî vacation notification CSS]
- [Source: _bmad-output/implementation-artifacts/2-2-inline-expand-stat-cards.md ‚Äî –ø–æ–ø–µ—Ä–µ–¥–Ω—è story]
- [Source: _bmad-output/implementation-artifacts/2-1-dashboard-events-api-timeline.md ‚Äî –ø–æ–ø–µ—Ä–µ–¥–Ω—è story, timezone fix]

## Dev Agent Record

### Agent Model Used

Claude Opus 4.6

### Debug Log References

- Production build passed successfully (vite build, 432ms, no errors)
- No test framework configured in project (no jest/vitest/cypress)

### Completion Notes List

- Task 1: Changed `.vacation-notification-overlay` background from `rgba(0, 0, 0, 0.5)` to `rgba(0, 0, 0, 0.3)` in styles.css line 959 ‚Äî aligns with UX specification
- Task 2: Added `handleGlobalKeydown()` function + `document.addEventListener('keydown', ...)` in `onMounted` + `document.removeEventListener` in `onUnmounted` for Escape key support. Chose variant B (onMounted/onUnmounted lifecycle) over variant A (Vue directive) for consistency with existing codebase pattern
- Task 3: Verified all 5 existing AC implementations ‚Äî all correct, no changes needed. Conditional rendering via `v-if`, modal show logic via `showVacationNotification` ref guard, max-width 500px confirmed in CSS
- Task 4: All AC validated. Production build passed (432ms, 0 errors). Backdrop opacity confirmed at 0.3. Escape key handler verified in code

### File List

- `client/src/styles.css` ‚Äî modified (line 959: backdrop rgba(0,0,0,0.5) ‚Üí rgba(0,0,0,0.3))
- `client/src/App.vue` ‚Äî modified (added handleGlobalKeydown function, updated onMounted/onUnmounted with keydown listener for Escape key)
- `_bmad-output/implementation-artifacts/sprint-status.yaml` ‚Äî modified (2-3-enhanced-notifications-modal: ready-for-dev ‚Üí in-progress ‚Üí review)
- `_bmad-output/implementation-artifacts/2-3-enhanced-notifications-modal.md` ‚Äî modified (tasks marked complete, dev agent record, status ‚Üí review)

## Change Log

- 2026-02-09: Story 2.3 implemented ‚Äî Enhanced Notifications Modal. Changed backdrop opacity from 0.5 to 0.3 per UX spec. Added Escape key handler for closing modal via onMounted/onUnmounted lifecycle pattern. All 6 AC verified (5 were already implemented, 2 minor changes applied).
- 2026-02-09: Code review fixes ‚Äî [H1] Fixed timezone bug in checkVacations(): replaced toISOString().split('T')[0] with local date construction to prevent wrong date near midnight in non-UTC timezones. [M2] Fixed undefined CSS variable var(--radius) ‚Üí var(--radius-lg) in .vacation-notification-modal border-radius. Production build passed (429ms).
- 2026-02-09: Code review #2 fixes ‚Äî [H1] Fixed endDate display in notification modal: used formatEventDate() instead of raw YYYY-MM-DD format. [M1] Removed 6 debug console.log() calls from checkVacations() function. Production build passed (426ms).
